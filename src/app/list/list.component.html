<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a routerLink="/">Home</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">Pets List</li>
    </ol>
</nav>

<h1 class="h3 mb-4">Browse Pets</h1>

<!-- Search Form -->
<div class="row mb-4">
    <div class="col-md-5 mb-2 mb-md-0">
        <div class="input-group">
            <span class="input-group-text">
                <i class="fa-solid fa-magnifying-glass"></i>
            </span>
            <input type="text" class="form-control" [(ngModel)]="searchName" placeholder="Search by name...">
        </div>
    </div>
    <div class="col-md-5 mb-2 mb-md-0">
        <div class="input-group">
            <span class="input-group-text">
                <i class="fa-solid fa-paw"></i>
            </span>
            <input type="text" class="form-control" [(ngModel)]="searchBreed" placeholder="Search by breed...">
        </div>
    </div>
    <div class="col-md-2">
        <button class="btn btn-primary w-100" (click)="search()">
            <i class="fa-solid fa-filter"></i> Filter
        </button>
    </div>
</div>

<!-- Loading Spinner -->
<div *ngIf="!data" class="text-center my-5">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading pets...</p>
</div>

<!-- Content -->
<div *ngIf="data">
    <!-- Pagination Top -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="text-muted">
            Showing {{ data.numberOfElements }} of {{ data.totalElements }} pets
        </div>
        <nav>
            <ul class="pagination mb-0">
                <li class="page-item" [class.disabled]="data.first">
                    <button class="page-link" (click)="first()">
                        <i class="fa-solid fa-angles-left"></i>
                    </button>
                </li>
                <li class="page-item" [class.disabled]="data.first">
                    <button class="page-link" (click)="previous()">
                        <i class="fa-solid fa-angle-left"></i>
                    </button>
                </li>
                <li class="page-item disabled">
                    <span class="page-link">
                        Page {{ data.number + 1 }} of {{ data.totalPages }}
                    </span>
                </li>
                <li class="page-item" [class.disabled]="data.last">
                    <button class="page-link" (click)="next()">
                        <i class="fa-solid fa-angle-right"></i>
                    </button>
                </li>
                <li class="page-item" [class.disabled]="data.last">
                    <button class="page-link" (click)="last()">
                        <i class="fa-solid fa-angles-right"></i>
                    </button>
                </li>
            </ul>
        </nav>
    </div>

    <!-- Pets Table -->
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-dark">
            <tr>
                <th scope="col">#</th>
                <th scope="col">Name</th>
                <th scope="col">Breed</th>
                <th scope="col">Origin</th>
                <th scope="col">Size</th>
                <th scope="col">Age</th>
                <th scope="col">Price</th>
                <th scope="col">Image</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let pet of data.content; let i = index">
                <th scope="row">{{ pet.id }}</th>
                <td>{{ pet.name }}</td>
                <td>{{ pet.breed }}</td>
                <td>{{ pet.origin }}</td>
                <td>
                        <span class="badge" [ngClass]="{
                            'bg-primary': pet.size === 'Small',
                            'bg-success': pet.size === 'Medium',
                            'bg-warning': pet.size === 'Large'
                        }">
                            {{ pet.size }}
                        </span>
                </td>
                <td>{{ pet.age }} year{{ pet.age === 1 ? '' : 's' }}</td>
                <td>
                        <span [ngSwitch]="pet.priceRange">
                            <span *ngSwitchCase="'$'" class="text-success">$ (Low)</span>
                            <span *ngSwitchCase="'$$'" class="text-primary">$$ (Medium)</span>
                            <span *ngSwitchCase="'$$$'" class="text-warning">$$$ (High)</span>
                            <span *ngSwitchCase="'$$$$'" class="text-danger">$$$$ (Premium)</span>
                            <span *ngSwitchDefault>{{ pet.priceRange }}</span>
                        </span>
                </td>
                <td>
                    <img [src]="pet.imageUrl" alt="{{ pet.name }}"
                         class="rounded" width="60" height="60"
                         style="object-fit: cover;">
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <a [routerLink]="['/pet', pet.id]"
                           class="btn btn-outline-primary"
                           title="View details">
                            <i class="fa-solid fa-eye"></i>
                        </a>
                        <button type="button"
                                class="btn btn-outline-success"
                                (click)="doAddToCart(pet.id)"
                                title="Add to cart">
                            <i class="fa-solid fa-cart-plus"></i>
                        </button>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Empty State -->
    <div *ngIf="data.empty" class="alert alert-info text-center">
        <i class="fa-solid fa-paw me-2"></i>
        No pets found matching your criteria.
    </div>

    <!-- Pagination Bottom -->
    <div class="d-flex justify-content-center mt-4">
        <nav>
            <ul class="pagination">
                <li class="page-item" [class.disabled]="data.first">
                    <button class="page-link" (click)="first()">
                        <i class="fa-solid fa-angles-left"></i> First
                    </button>
                </li>
                <li class="page-item" [class.disabled]="data.first">
                    <button class="page-link" (click)="previous()">
                        <i class="fa-solid fa-angle-left"></i> Previous
                    </button>
                </li>
                <li class="page-item disabled">
                    <span class="page-link">
                        Page {{ data.number + 1 }} of {{ data.totalPages }}
                    </span>
                </li>
                <li class="page-item" [class.disabled]="data.last">
                    <button class="page-link" (click)="next()">
                        Next <i class="fa-solid fa-angle-right"></i>
                    </button>
                </li>
                <li class="page-item" [class.disabled]="data.last">
                    <button class="page-link" (click)="last()">
                        Last <i class="fa-solid fa-angles-right"></i>
                    </button>
                </li>
            </ul>
        </nav>
    </div>
</div>